<!DOCTYPE html>
<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<head>
    <link rel="stylesheet" type="text/css" href="css/styles.css" media="screen"/>
</head>
<body>
<h1>Control LED light</h1>
<p><input type="checkbox" id="light"></p>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script> <!-- include socket.io client side script -->
<script>
    var socket = io(); //load socket.io-client and connect to the host that serves the page
    window.addEventListener("load", () => { //when page loads
        var lightbox = document.getElementById("light");
        lightbox.addEventListener("change", () => { //add event listener for when checkbox changes
            console.log(`The checked value is: ${lightbox.checked}`);
            socket.emit("light", Number(lightbox.checked)); //send button status to server (as 1 or 0)
        });
    });
    socket.on('light', (data) => { //get button status from client
        console.log(`New state from the Pi`);
        document.getElementById("light").checked = data; //change checkbox according to push button on Raspberry Pi
        socket.emit("light", data); //send push button status to back to server
    });
</script>
<br>
<h1>Element Temperature</h1>
<div class="slidecontainer">
    <input type="range" min="0" max="100" value="50" class="slider" id="elementTemp">
    <p>Value: <span id="demo"></span></p>
    <input type="button" value="Set Temp" id="elementButton"/>
</div>
<h1>Circulation Pump</h1>
<div class="pumpContainer">
    <input type="button" value="OFF" id="pump"/>
</div>
<script>
    var slider = document.getElementById("elementTemp");
    var output = document.getElementById("demo");
    output.innerHTML = slider.value;

    slider.oninput = function() {
        output.innerHTML = this.value;
    }
    var socket = io(); //load socket.io-client and connect to the host that serves the page
    window.addEventListener("load", () => { //when page loads
        document.getElementById("pump").addEventListener("click", () => {
            if(pump.value === 'ON') {
                console.log("Turning pump off");
                pump.value = 'OFF';
                socket.emit("pumpOn", false);
            } else {
                console.log("Turning pump on");
                pump.value = 'ON';
                socket.emit("pumpOn", true);
            }
        });

        var lightbox = document.getElementById("light");
        lightbox.addEventListener("change", () => { //add event listener for when checkbox changes
            console.log(`The checked value is: ${lightbox.checked}`);
            socket.emit("light", Number(lightbox.checked)); //send button status to server (as 1 or 0)
        });

        var elementButton = document.getElementById("elementButton");
        elementButton.addEventListener("click", () => {
            console.log("Recieved setTemp event");
            console.log(`Setting temp to: ${slider.value}`);
            socket.emit("setTemp", Number(slider.value));
        });
    });
    socket.on('light', (data) => { //get button status from client
        console.log(`New state from the Pi`);
        document.getElementById("light").checked = data; //change checkbox according to push button on Raspberry Pi
        socket.emit("light", data); //send push button status to back to server
    });
</script>
</body>
</html>